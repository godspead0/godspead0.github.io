<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>主题：Web 核心知识与 Spring 分层开发实战指南（重点补充 Cookie 与 Session），包括 HTTP 协议基础（请求和响应数据格式）、Java Web 中请求/响应封装，以及 Cookie 和 Session 的核心知识（定义、特性、生命周期、配置等）、对比与选型 | godspead的全栈文档</title>
    <meta name="description" content="记录我学过的一切">
    <meta name="generator" content="VitePress v1.6.4">
    <link rel="preload stylesheet" href="/assets/style.CwNnKCVM.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    
    <script type="module" src="/assets/app.CjjlkSPj.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/theme.dyN886cm.js">
    <link rel="modulepreload" href="/assets/chunks/framework.BR0IJ75L.js">
    <link rel="modulepreload" href="/assets/notes_core_架构部分_web与后端的架构问题.md.Cl_y-d1c.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-d8b57b2d><!--[--><!--]--><!--[--><span tabindex="-1" data-v-fcbfc0e0></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-fcbfc0e0>Skip to content</a><!--]--><!----><header class="VPNav" data-v-d8b57b2d data-v-7ad780c2><div class="VPNavBar" data-v-7ad780c2 data-v-9fd4d1dd><div class="wrapper" data-v-9fd4d1dd><div class="container" data-v-9fd4d1dd><div class="title" data-v-9fd4d1dd><div class="VPNavBarTitle has-sidebar" data-v-9fd4d1dd data-v-9f43907a><a class="title" href="/" data-v-9f43907a><!--[--><!--]--><!----><span data-v-9f43907a>godspead的全栈文档</span><!--[--><!--]--></a></div></div><div class="content" data-v-9fd4d1dd><div class="content-body" data-v-9fd4d1dd><!--[--><!--]--><div class="VPNavBarSearch search" data-v-9fd4d1dd><!----></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-9fd4d1dd data-v-afb2845e><span id="main-nav-aria-label" class="visually-hidden" data-v-afb2845e> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>Home</span><!--]--></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-afb2845e data-v-bfe7971f><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-bfe7971f><span class="text" data-v-bfe7971f><!----><span data-v-bfe7971f>前端</span><span class="vpi-chevron-down text-icon" data-v-bfe7971f></span></span></button><div class="menu" data-v-bfe7971f><div class="VPMenu" data-v-bfe7971f data-v-20ed86d6><div class="items" data-v-20ed86d6><!--[--><!--[--><div class="VPMenuLink" data-v-20ed86d6 data-v-7eeeb2dc><a class="VPLink link" href="/notes/frontend/js.html" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>JavaScript</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-20ed86d6 data-v-7eeeb2dc><a class="VPLink link" href="/notes/frontend/vue.html" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>Vue</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-20ed86d6 data-v-7eeeb2dc><a class="VPLink link" href="/notes/frontend/css.html" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>CSS</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-9fd4d1dd data-v-3f90c1a5><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-3f90c1a5 data-v-be9742d9 data-v-b4ccac88><span class="check" data-v-b4ccac88><span class="icon" data-v-b4ccac88><!--[--><span class="vpi-sun sun" data-v-be9742d9></span><span class="vpi-moon moon" data-v-be9742d9></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-9fd4d1dd data-v-ef6192dc data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="https://github.com/vuejs/vitepress" aria-label="github" target="_blank" rel="noopener" data-v-e71e869c data-v-60a9a2d3><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-9fd4d1dd data-v-f953d92f data-v-bfe7971f><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-bfe7971f><span class="vpi-more-horizontal icon" data-v-bfe7971f></span></button><div class="menu" data-v-bfe7971f><div class="VPMenu" data-v-bfe7971f data-v-20ed86d6><!----><!--[--><!--[--><!----><div class="group" data-v-f953d92f><div class="item appearance" data-v-f953d92f><p class="label" data-v-f953d92f>Appearance</p><div class="appearance-action" data-v-f953d92f><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-f953d92f data-v-be9742d9 data-v-b4ccac88><span class="check" data-v-b4ccac88><span class="icon" data-v-b4ccac88><!--[--><span class="vpi-sun sun" data-v-be9742d9></span><span class="vpi-moon moon" data-v-be9742d9></span><!--]--></span></span></button></div></div></div><div class="group" data-v-f953d92f><div class="item social-links" data-v-f953d92f><div class="VPSocialLinks social-links-list" data-v-f953d92f data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="https://github.com/vuejs/vitepress" aria-label="github" target="_blank" rel="noopener" data-v-e71e869c data-v-60a9a2d3><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-9fd4d1dd data-v-6bee1efd><span class="container" data-v-6bee1efd><span class="top" data-v-6bee1efd></span><span class="middle" data-v-6bee1efd></span><span class="bottom" data-v-6bee1efd></span></span></button></div></div></div></div><div class="divider" data-v-9fd4d1dd><div class="divider-line" data-v-9fd4d1dd></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-d8b57b2d data-v-2488c25a><div class="container" data-v-2488c25a><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-2488c25a><span class="vpi-align-left menu-icon" data-v-2488c25a></span><span class="menu-text" data-v-2488c25a>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-2488c25a data-v-6b867909><button data-v-6b867909>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-d8b57b2d data-v-42c4c606><div class="curtain" data-v-42c4c606></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-42c4c606><span class="visually-hidden" id="sidebar-aria-label" data-v-42c4c606> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0" data-v-51288d80 data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h2 class="text" data-v-0009425e>Examples</h2><!----></div><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/markdown-examples.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Markdown Examples</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/api-examples.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Runtime API Examples</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-d8b57b2d data-v-9a6c75ad><div class="VPDoc has-sidebar has-aside" data-v-9a6c75ad data-v-e6f2a212><!--[--><!--]--><div class="container" data-v-e6f2a212><div class="aside" data-v-e6f2a212><div class="aside-curtain" data-v-e6f2a212></div><div class="aside-container" data-v-e6f2a212><div class="aside-content" data-v-e6f2a212><div class="VPDocAside" data-v-e6f2a212 data-v-cb998dce><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-cb998dce data-v-f610f197><div class="content" data-v-f610f197><div class="outline-marker" data-v-f610f197></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-f610f197>On this page</div><ul class="VPDocOutlineItem root" data-v-f610f197 data-v-53c99d69><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-cb998dce></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-e6f2a212><div class="content-container" data-v-e6f2a212><!--[--><!--]--><main class="main" data-v-e6f2a212><div style="position:relative;" class="vp-doc _notes_core_%E6%9E%B6%E6%9E%84%E9%83%A8%E5%88%86_web%E4%B8%8E%E5%90%8E%E7%AB%AF%E7%9A%84%E6%9E%B6%E6%9E%84%E9%97%AE%E9%A2%98" data-v-e6f2a212><div><h1 id="主题-web-核心知识与-spring-分层开发实战指南-重点补充-cookie-与-session-包括-http-协议基础-请求和响应数据格式-、java-web-中请求-响应封装-以及-cookie-和-session-的核心知识-定义、特性、生命周期、配置等-、对比与选型" tabindex="-1"><strong>主题</strong>：Web 核心知识与 Spring 分层开发实战指南（重点补充 Cookie 与 Session），包括 HTTP 协议基础（请求和响应数据格式）、Java Web 中请求/响应封装，以及 Cookie 和 Session 的核心知识（定义、特性、生命周期、配置等）、对比与选型 <a class="header-anchor" href="#主题-web-核心知识与-spring-分层开发实战指南-重点补充-cookie-与-session-包括-http-协议基础-请求和响应数据格式-、java-web-中请求-响应封装-以及-cookie-和-session-的核心知识-定义、特性、生命周期、配置等-、对比与选型" aria-label="Permalink to &quot;**主题**：Web 核心知识与 Spring 分层开发实战指南（重点补充 Cookie 与 Session），包括 HTTP 协议基础（请求和响应数据格式）、Java Web 中请求/响应封装，以及 Cookie 和 Session 的核心知识（定义、特性、生命周期、配置等）、对比与选型&quot;">​</a></h1><h1 id="web-核心知识与-spring-分层开发实战指南-补充-cookie-与-session" tabindex="-1">Web 核心知识与 Spring 分层开发实战指南（补充：Cookie 与 Session） <a class="header-anchor" href="#web-核心知识与-spring-分层开发实战指南-补充-cookie-与-session" aria-label="Permalink to &quot;Web 核心知识与 Spring 分层开发实战指南（补充：Cookie 与 Session）&quot;">​</a></h1><h2 id="一、http-协议基础" tabindex="-1">一、HTTP 协议基础 <a class="header-anchor" href="#一、http-协议基础" aria-label="Permalink to &quot;一、HTTP 协议基础&quot;">​</a></h2><p>HTTP（HyperText Transfer Protocol，超文本传输协议）是前后端通信的核心协议，定义了客户端与服务器之间请求和响应的数据格式、传输规则，基于 TCP/IP 协议族，属于<strong>无状态协议</strong>（每次请求独立，不保留上下文）。</p><p>无状态协议的核心问题：无法识别连续请求的关联性（如用户登录后，后续请求无法证明“已登录”）。为解决该问题，诞生了 <strong>Cookie</strong> 和 <strong>Session</strong> 两种状态保持机制。</p><h3 id="_1-1-请求数据格式" tabindex="-1">1.1 请求数据格式 <a class="header-anchor" href="#_1-1-请求数据格式" aria-label="Permalink to &quot;1.1 请求数据格式&quot;">​</a></h3><p>HTTP 请求由 <strong>请求行、请求头、请求体</strong> 三部分组成，三部分之间以空行（<code>\r\n</code>）分隔，缺一不可。这是 HTTP 协议的强制分隔规则，少了会导致服务器解析失败。</p><h4 id="_1-1-1-核心组成" tabindex="-1">1.1.1 核心组成 <a class="header-anchor" href="#_1-1-1-核心组成" aria-label="Permalink to &quot;1.1.1 核心组成&quot;">​</a></h4><table tabindex="0"><thead><tr><th>部分</th><th>格式说明</th><th>示例</th></tr></thead><tbody><tr><td>请求行</td><td><code>请求方式 + 资源路径 + 协议版本</code>（空格分隔），是请求的核心标识</td><td><code>POST /api/user/add HTTP/1.1</code></td></tr><tr><td>请求头</td><td>键值对格式（<code>Key: Value</code>），传递客户端环境、请求附加信息，可多个</td><td><code>Host: localhost:8080</code><br><code>Content-Type: application/json</code><br><code>Cookie: userId=1; username=test</code></td></tr><tr><td>请求体</td><td>存放请求的核心数据（如表单、JSON），仅特定请求方式支持</td><td><code>{&quot;username&quot;:&quot;test&quot;,&quot;password&quot;:&quot;123456&quot;}</code></td></tr></tbody></table><h4 id="_1-1-2-关键细节" tabindex="-1">1.1.2 关键细节 <a class="header-anchor" href="#_1-1-2-关键细节" aria-label="Permalink to &quot;1.1.2 关键细节&quot;">​</a></h4><ul><li><strong>请求方式分类</strong>： <ul><li>安全请求（不修改服务器数据）：<code>GET</code>（查询）、<code>HEAD</code>（仅返回响应头）、<code>OPTIONS</code>（预检请求）；</li><li>非安全请求（修改服务器数据）：<code>POST</code>（新增）、<code>PUT</code>（全量更新）、<code>PATCH</code>（部分更新）、<code>DELETE</code>（删除）。</li></ul></li><li><strong>请求体使用限制</strong>： <ul><li><code>GET</code> 请求无请求体，参数通过 URL 拼接（<code>?key1=value1&amp;key2=value2</code>），长度受浏览器限制（通常 2KB-8KB）；</li><li><code>POST/PUT/PATCH</code> 支持请求体，可传输大量数据（如 JSON、文件流），大小无严格限制（由服务器配置决定）。</li></ul></li><li><strong>核心请求头说明</strong>： <ul><li><code>Content-Type</code>：指定请求体格式（<code>application/json</code> 为 JSON 数据，<code>application/x-www-form-urlencoded</code> 为表单数据，<code>multipart/form-data</code> 为文件上传）；</li><li><code>Authorization</code>：身份验证信息（如 JWT Token，格式 <code>Bearer &lt;token&gt;</code>）；</li><li><code>Accept</code>：客户端可接收的响应数据格式（如 <code>application/json</code>）；</li><li><code>Cookie</code>：客户端携带的 Cookie 数据（键值对用分号分隔，是状态保持的核心请求头）。</li></ul></li></ul><h3 id="_1-2-响应数据格式" tabindex="-1">1.2 响应数据格式 <a class="header-anchor" href="#_1-2-响应数据格式" aria-label="Permalink to &quot;1.2 响应数据格式&quot;">​</a></h3><p>HTTP 响应与请求对应，由 <strong>响应行、响应头、响应体</strong> 三部分组成，同样以空行分隔。</p><h4 id="_1-2-1-核心组成" tabindex="-1">1.2.1 核心组成 <a class="header-anchor" href="#_1-2-1-核心组成" aria-label="Permalink to &quot;1.2.1 核心组成&quot;">​</a></h4><table tabindex="0"><thead><tr><th>部分</th><th>格式说明</th><th>示例</th></tr></thead><tbody><tr><td>响应行</td><td><code>协议版本 + 状态码 + 状态描述</code>（空格分隔），标识响应结果</td><td><code>HTTP/1.1 200 OK</code></td></tr><tr><td>响应头</td><td>键值对格式，传递服务器环境、响应附加信息</td><td><code>Content-Type: application/json</code><br><code>Set-Cookie: userId=1; Max-Age=3600; Path=/</code></td></tr><tr><td>响应体</td><td>服务器返回的实际数据（如 JSON、HTML、图片流），是前后端交互的核心内容</td><td><code>{&quot;code&quot;:200,&quot;msg&quot;:&quot;success&quot;,&quot;data&quot;:{&quot;id&quot;:1,&quot;username&quot;:&quot;test&quot;}}</code></td></tr></tbody></table><h4 id="_1-2-2-关键细节" tabindex="-1">1.2.2 关键细节 <a class="header-anchor" href="#_1-2-2-关键细节" aria-label="Permalink to &quot;1.2.2 关键细节&quot;">​</a></h4><ul><li><strong>状态码分类</strong>（核心状态码必须掌握）： <ul><li>2xx 成功：<code>200 OK</code>（请求成功）、<code>201 Created</code>（资源创建成功）；</li><li>3xx 重定向：<code>301 永久重定向</code>、<code>302 临时重定向</code>、<code>304 Not Modified</code>（缓存命中）；</li><li>4xx 客户端错误：<code>400 Bad Request</code>（请求参数错误）、<code>401 Unauthorized</code>（未授权）、<code>403 Forbidden</code>（权限不足）、<code>404 Not Found</code>（资源不存在）；</li><li>5xx 服务器错误：<code>500 Internal Server Error</code>（服务器内部错误）、<code>503 Service Unavailable</code>（服务不可用）。</li></ul></li><li><strong>核心响应头说明</strong>： <ul><li><code>Content-Type</code>：指定响应体格式（与请求头对应，前端据此解析数据）；</li><li><code>Set-Cookie</code>：服务器向客户端设置 Cookie 的核心响应头（包含 Cookie 键值、生命周期、作用域等配置）；</li><li><code>Access-Control-Allow-Origin</code>：解决跨域问题（指定允许访问的客户端域名）。</li></ul></li></ul><h3 id="_1-3-java-web-中的请求-响应封装" tabindex="-1">1.3 Java Web 中的请求/响应封装 <a class="header-anchor" href="#_1-3-java-web-中的请求-响应封装" aria-label="Permalink to &quot;1.3 Java Web 中的请求/响应封装&quot;">​</a></h3><p>在 Java Web（Spring MVC）中，HTTP 请求和响应会被自动封装为以下对象：</p><ul><li><strong><code>HttpServletRequest</code></strong>：封装所有请求信息，可通过其获取： <ul><li>请求方式：<code>request.getMethod()</code>；</li><li>资源路径：<code>request.getRequestURI()</code>；</li><li>请求参数：<code>request.getParameter(&quot;key&quot;)</code>（表单参数）、<code>request.getInputStream()</code>（请求体流）；</li><li>请求头：<code>request.getHeader(&quot;Content-Type&quot;)</code>；</li><li>Cookie 数据：<code>request.getCookies()</code>（获取客户端携带的所有 Cookie）。</li></ul></li><li><strong><code>HttpServletResponse</code></strong>：封装响应信息，可通过其设置： <ul><li>状态码：<code>response.setStatus(200)</code>；</li><li>响应头：<code>response.setHeader(&quot;Content-Type&quot;, &quot;application/json&quot;)</code>；</li><li>响应体：<code>response.getWriter().write(&quot;json字符串&quot;)</code>；</li><li>设置 Cookie：<code>response.addCookie(Cookie cookie)</code>（向客户端写入 Cookie）。</li></ul></li></ul><h2 id="二、状态保持机制-cookie-与-session-详解" tabindex="-1">二、状态保持机制：Cookie 与 Session 详解 <a class="header-anchor" href="#二、状态保持机制-cookie-与-session-详解" aria-label="Permalink to &quot;二、状态保持机制：Cookie 与 Session 详解&quot;">​</a></h2><p>HTTP 协议的无状态性导致无法维持用户会话（如登录后后续请求需重复验证），Cookie 和 Session 是解决该问题的核心方案，二者协同工作实现“状态保持”。</p><h3 id="_2-1-cookie-核心知识" tabindex="-1">2.1 Cookie 核心知识 <a class="header-anchor" href="#_2-1-cookie-核心知识" aria-label="Permalink to &quot;2.1 Cookie 核心知识&quot;">​</a></h3><h4 id="_2-1-1-定义与本质" tabindex="-1">2.1.1 定义与本质 <a class="header-anchor" href="#_2-1-1-定义与本质" aria-label="Permalink to &quot;2.1.1 定义与本质&quot;">​</a></h4><p>Cookie 是<strong>客户端浏览器端的小型文本数据存储机制</strong>，基于 HTTP 协议的 <code>Set-Cookie</code> 响应头和 <code>Cookie</code> 请求头实现：</p><ul><li>服务器通过 <code>Set-Cookie</code> 响应头向客户端发送 Cookie 数据；</li><li>客户端（浏览器）将 Cookie 存储在本地（内存或硬盘）；</li><li>后续客户端向同一服务器发送请求时，会自动在 <code>Cookie</code> 请求头中携带该 Cookie 数据，供服务器识别用户身份。</li></ul><h4 id="_2-1-2-cookie-的核心特性" tabindex="-1">2.1.2 Cookie 的核心特性 <a class="header-anchor" href="#_2-1-2-cookie-的核心特性" aria-label="Permalink to &quot;2.1.2 Cookie 的核心特性&quot;">​</a></h4><ol><li><strong>存储位置</strong>：客户端浏览器（内存/硬盘，由生命周期决定）；</li><li><strong>数据格式</strong>：键值对（<code>key=value</code>），多个 Cookie 用分号 <code>;</code> 分隔；</li><li><strong>大小限制</strong>：单个 Cookie 容量通常不超过 4KB（不同浏览器略有差异）；</li><li><strong>数量限制</strong>：单个域名下的 Cookie 数量通常不超过 50 个（浏览器限制）；</li><li><strong>安全性</strong>：默认明文存储（敏感数据需加密），可被客户端修改（需谨慎使用）；</li><li><strong>跨域限制</strong>：Cookie 遵循“同源策略”，仅向设置它的域名发送（如 <code>www.baidu.com</code> 的 Cookie 不会发送给 <code>www.google.com</code>）。</li></ol><h4 id="_2-1-3-cookie-生命周期-setmaxage-int-seconds" tabindex="-1">2.1.3 Cookie 生命周期（<code>setMaxAge(int seconds)</code>） <a class="header-anchor" href="#_2-1-3-cookie-生命周期-setmaxage-int-seconds" aria-label="Permalink to &quot;2.1.3 Cookie 生命周期（`setMaxAge(int seconds)`）&quot;">​</a></h4><p>Cookie 的生命周期决定了其存储位置和存活时间，通过 <code>Cookie.setMaxAge(int seconds)</code> 方法设置（单位：秒），不同参数值对应不同行为：</p><table tabindex="0"><thead><tr><th><code>setMaxAge</code> 参数值</th><th>生命周期说明</th><th>存储位置</th><th>典型场景</th></tr></thead><tbody><tr><td>正数（如 3600）</td><td>Cookie 存活指定秒数，到期后自动删除</td><td>硬盘</td><td>记住登录状态（1 小时有效）</td></tr><tr><td>负数（默认 -1）</td><td>Cookie 仅在当前浏览器会话有效，浏览器关闭后立即销毁（会话级 Cookie）</td><td>内存</td><td>临时会话保持（无需持久化）</td></tr><tr><td>0</td><td>立即删除客户端已存储的该 Cookie（强制失效）</td><td>-</td><td>退出登录（清除登录状态）</td></tr></tbody></table><p>注意：若不调用 <code>setMaxAge</code> 方法，Cookie 默认为会话级（<code>maxAge=-1</code>），浏览器关闭后即消失。</p><h4 id="_2-1-4-cookie-核心配置-java-代码示例" tabindex="-1">2.1.4 Cookie 核心配置（Java 代码示例） <a class="header-anchor" href="#_2-1-4-cookie-核心配置-java-代码示例" aria-label="Permalink to &quot;2.1.4 Cookie 核心配置（Java 代码示例）&quot;">​</a></h4><p>在 Spring MVC 中，通过 <code>javax.servlet.http.Cookie</code> 类创建 Cookie 并配置核心属性：</p><div class="language-Java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">Java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RestController</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> CookieController</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 向客户端设置 Cookie</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GetMapping</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/set-cookie&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> String </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setCookie</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(HttpServletResponse </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">response</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 1. 创建 Cookie（键值对）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        Cookie userIdCookie </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Cookie</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;userId&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;1001&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        Cookie usernameCookie </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Cookie</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;username&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;test_user&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 2. 配置生命周期（1 小时 = 3600 秒）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        userIdCookie.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setMaxAge</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3600</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 3. 配置作用路径（仅 /api 路径下的请求会携带该 Cookie）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        userIdCookie.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setPath</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/api&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 4. 配置作用域（仅指定域名下有效，默认为当前域名）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        userIdCookie.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setDomain</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;localhost&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 5. 配置 HttpOnly（true 表示客户端 JS 无法读取，防止 XSS 攻击）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        userIdCookie.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setHttpOnly</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 6. 配置 Secure（true 表示仅 HTTPS 协议下传输，HTTP 不传输）</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // userIdCookie.setSecure(true);</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // 生产环境推荐开启</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 7. 向响应中添加 Cookie（通过 Set-Cookie 头发送给客户端）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        response.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addCookie</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(userIdCookie);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        response.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addCookie</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(usernameCookie);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Cookie 设置成功&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 读取客户端携带的 Cookie</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GetMapping</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/get-cookie&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> String </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getCookie</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(HttpServletRequest </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">request</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        StringBuilder cookieInfo </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> StringBuilder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 获取所有 Cookie（无 Cookie 时返回 null，需判空）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        Cookie</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[] cookies </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> request.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getCookies</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (cookies </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (Cookie cookie </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cookies) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                String name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cookie.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                String value </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cookie.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getValue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                cookieInfo.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">append</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(name).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">append</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;=&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">append</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(value).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">append</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;; &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;客户端 Cookie：&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cookieInfo;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 删除 Cookie</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GetMapping</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/delete-cookie&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> String </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">deleteCookie</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(HttpServletResponse </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">response</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 删除 Cookie 的核心：创建同名、同路径的 Cookie，设置 maxAge=0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        Cookie userIdCookie </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Cookie</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;userId&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        userIdCookie.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setPath</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/api&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 必须与设置时的路径一致，否则删除失败</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        userIdCookie.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setMaxAge</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 立即删除</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        response.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addCookie</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(userIdCookie);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Cookie 删除成功&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h4 id="_2-1-5-cookie-关键配置说明" tabindex="-1">2.1.5 Cookie 关键配置说明 <a class="header-anchor" href="#_2-1-5-cookie-关键配置说明" aria-label="Permalink to &quot;2.1.5 Cookie 关键配置说明&quot;">​</a></h4><ul><li><strong><code>setPath(String path)</code></strong>：指定 Cookie 的作用路径（如 <code>/api</code>），仅客户端向该路径发送请求时才携带该 Cookie（默认路径为当前请求路径的父路径）；</li><li><strong><code>setDomain(String domain)</code></strong>：指定 Cookie 的作用域（如 <code>xxx.com</code>），子域名（如 <code>a.xxx.com</code>）可共享该 Cookie（默认仅当前域名有效）；</li><li><strong><code>setHttpOnly(boolean httpOnly)</code></strong>：开启后客户端 JavaScript 无法通过 <code>document.cookie</code> 读取该 Cookie，有效防止 XSS 攻击（生产环境推荐开启）；</li><li><strong><code>setSecure(boolean secure)</code></strong>：开启后仅在 HTTPS 协议下传输 Cookie，HTTP 协议不传输（防止 Cookie 被窃听，生产环境推荐开启）；</li><li><strong><code>setComment(String comment)</code></strong>：Cookie 描述信息（浏览器通常不显示，仅调试用）。</li></ul><h3 id="_2-2-session-核心知识" tabindex="-1">2.2 Session 核心知识 <a class="header-anchor" href="#_2-2-session-核心知识" aria-label="Permalink to &quot;2.2 Session 核心知识&quot;">​</a></h3><h4 id="_2-2-1-定义与本质" tabindex="-1">2.2.1 定义与本质 <a class="header-anchor" href="#_2-2-1-定义与本质" aria-label="Permalink to &quot;2.2.1 定义与本质&quot;">​</a></h4><p>Session 是<strong>服务器端的会话存储机制</strong>，用于存储用户会话数据（如登录状态、用户信息）。核心逻辑：</p><ul><li>服务器为每个新用户创建唯一的 Session 对象（包含 Session ID）；</li><li>服务器通过 Cookie 将 Session ID 发送给客户端（默认 Cookie 名为 <code>JSESSIONID</code>）；</li><li>客户端后续请求携带该 Cookie（Session ID），服务器通过 Session ID 找到对应的 Session 对象，从而识别用户身份。</li></ul><p>核心关联：Session 依赖 Cookie 传递 Session ID（无 Cookie 时需通过 URL 重写传递，但不推荐）。</p><h4 id="_2-2-2-session-的核心特性" tabindex="-1">2.2.2 Session 的核心特性 <a class="header-anchor" href="#_2-2-2-session-的核心特性" aria-label="Permalink to &quot;2.2.2 Session 的核心特性&quot;">​</a></h4><ol><li><strong>存储位置</strong>：服务器端（内存、硬盘、数据库等，默认内存）；</li><li><strong>数据格式</strong>：键值对（<code>String -&gt; Object</code>），可存储复杂对象（如 User 实体）；</li><li><strong>大小限制</strong>：无明确限制（由服务器内存决定，避免存储大量数据）；</li><li><strong>安全性</strong>：数据存储在服务器端，客户端仅持有 Session ID（敏感数据更安全）；</li><li><strong>生命周期</strong>：默认由服务器管理（超时自动销毁，默认超时时间通常为 30 分钟）；</li><li><strong>跨域限制</strong>：Session 依赖 Cookie 传递 Session ID，受同源策略限制（跨域需特殊处理）。</li></ol><h4 id="_2-2-3-session-生命周期与配置" tabindex="-1">2.2.3 Session 生命周期与配置 <a class="header-anchor" href="#_2-2-3-session-生命周期与配置" aria-label="Permalink to &quot;2.2.3 Session 生命周期与配置&quot;">​</a></h4><ol><li><strong>创建时机</strong>：用户第一次访问服务器（如未携带有效 Session ID）时，服务器自动创建 Session；</li><li><strong>销毁时机</strong>： <ol><li>会话超时（服务器未收到该 Session 的请求，达到超时时间）；</li><li>服务器主动调用 <code>session.invalidate()</code> 方法（如退出登录）；</li><li>服务器重启或 Session 存储介质（如内存）被清理。</li></ol></li><li><strong>Session 超时配置（Spring Boot 项目）</strong>： <ol><li>配置文件方式（<code>application.yml</code>）： <ul><li><div class="language-YAML vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">YAML</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    servlet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      session</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        timeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">1800s</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 超时时间 30 分钟（默认值，单位可省略，默认秒）</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        cookie</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">          http-only</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> #  Session ID 对应的 Cookie 开启 HttpOnly</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">          secure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 仅 HTTPS 传输（生产环境推荐）</span></span></code></pre></div></li></ul></li><li>代码方式（手动设置超时时间）： <ul><li><div class="language-Java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">Java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GetMapping</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/set-session-timeout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  public</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> String </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setSessionTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(HttpSession session) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      session.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setMaxInactiveInterval</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3600</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 超时时间 1 小时（单位：秒）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      return</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Session 超时时间设置为 1 小时&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span></code></pre></div></li></ul></li></ol></li></ol><h4 id="_2-2-4-session-核心操作-java-代码示例" tabindex="-1">2.2.4 Session 核心操作（Java 代码示例） <a class="header-anchor" href="#_2-2-4-session-核心操作-java-代码示例" aria-label="Permalink to &quot;2.2.4 Session 核心操作（Java 代码示例）&quot;">​</a></h4><p>在 Spring MVC 中，通过 <code>HttpSession</code> 对象操作 Session 数据：</p><div class="language-Java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">Java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RestController</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SessionController</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 登录：创建 Session 并存储用户信息</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PostMapping</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/login&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> String </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">login</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RequestBody</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> UserLoginDTO </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">loginDTO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, HttpSession </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">session</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 模拟数据库校验用户名密码</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">equals</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(loginDTO.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getUsername</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;&amp;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;123456&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">equals</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(loginDTO.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getPassword</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            // 存储用户信息到 Session（键值对，可存储对象）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            session.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setAttribute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;loginUser&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> User</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1001</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;test@xxx.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">));</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            // 获取 Session ID（服务器自动生成，通过 Cookie 发送给客户端）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            String sessionId </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> session.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            return</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;登录成功，Session ID：&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sessionId;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;用户名或密码错误&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 验证登录状态：从 Session 获取用户信息</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GetMapping</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/check-login&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> String </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">checkLogin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(HttpSession </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">session</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        User loginUser </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (User) session.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getAttribute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;loginUser&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (loginUser </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            return</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;已登录，用户信息：&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> loginUser.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getUsername</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;(&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> loginUser.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getEmail</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;未登录&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 退出登录：销毁 Session</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GetMapping</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/logout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> String </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">logout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(HttpSession </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">session</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        session.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">invalidate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 强制销毁当前 Session（清除所有数据）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;退出登录成功&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="_2-3-cookie-与-session-对比与选型" tabindex="-1">2.3 Cookie 与 Session 对比与选型 <a class="header-anchor" href="#_2-3-cookie-与-session-对比与选型" aria-label="Permalink to &quot;2.3 Cookie 与 Session 对比与选型&quot;">​</a></h3><table tabindex="0"><thead><tr><th>对比维度</th><th>Cookie</th><th>Session</th></tr></thead><tbody><tr><td>存储位置</td><td>客户端（浏览器）</td><td>服务器端</td></tr><tr><td>数据安全性</td><td>较低（明文存储，可被客户端修改）</td><td>较高（数据在服务器，客户端仅持 Session ID）</td></tr><tr><td>数据类型限制</td><td>仅支持字符串（需手动序列化复杂数据）</td><td>支持任意 Object 类型（直接存储对象）</td></tr><tr><td>大小限制</td><td>单个 4KB，数量限制（50 个/域名）</td><td>无明确限制（受服务器内存影响）</td></tr><tr><td>生命周期</td><td>可通过 <code>setMaxAge</code> 精确控制（持久/会话）</td><td>默认超时销毁（30 分钟），可手动配置</td></tr><tr><td>服务器压力</td><td>无（数据在客户端）</td><td>有（数据在服务器，高并发需考虑存储方案）</td></tr><tr><td>跨域支持</td><td>受同源策略限制（可通过 CORS 配置部分支持）</td><td>依赖 Cookie，跨域需特殊处理（如共享 Session ID）</td></tr><tr><td>典型使用场景</td><td>存储非敏感数据（如记住登录状态、主题配置）</td><td>存储敏感数据（如用户信息、权限信息）</td></tr></tbody></table><h4 id="选型建议" tabindex="-1">选型建议 <a class="header-anchor" href="#选型建议" aria-label="Permalink to &quot;选型建议&quot;">​</a></h4><ol><li>存储<strong>非敏感、少量数据</strong>（如是否记住登录、语言偏好）→ 用 Cookie；</li><li>存储<strong>敏感、复杂数据</strong>（如用户 ID、权限角色）→ 用 Session；</li><li>高并发场景：Session 需避免存储在内存（可改用 Redis 存储 Session 数据，提高扩展性）；</li><li>跨域场景：优先使用 JWT（替代 Cookie+Session），或通过 CORS 配置允许跨域携带 Cookie。</li></ol><h3 id="_2-4-常见问题与解决方案" tabindex="-1">2.4 常见问题与解决方案 <a class="header-anchor" href="#_2-4-常见问题与解决方案" aria-label="Permalink to &quot;2.4 常见问题与解决方案&quot;">​</a></h3><h4 id="_2-4-1-问题-1-session-失效-登录状态丢失" tabindex="-1">2.4.1 问题 1：Session 失效（登录状态丢失） <a class="header-anchor" href="#_2-4-1-问题-1-session-失效-登录状态丢失" aria-label="Permalink to &quot;2.4.1 问题 1：Session 失效（登录状态丢失）&quot;">​</a></h4><ul><li>原因： <ul><li>Session 超时（默认 30 分钟无操作）；</li><li>服务器重启（内存中的 Session 被清理）；</li><li>客户端禁用 Cookie（无法传递 Session ID）；</li><li>跨域请求未携带 Cookie（同源策略限制）。</li></ul></li><li>解决方案： <ul><li>延长 Session 超时时间（根据业务需求配置）；</li><li>用 Redis 存储 Session（持久化，服务器重启不丢失）；</li><li>跨域场景：配置 <code>Access-Control-Allow-Credentials: true</code> 允许跨域携带 Cookie；</li><li>客户端禁用 Cookie 时：通过 URL 重写传递 Session ID（不推荐，安全性低）。</li></ul></li></ul><h4 id="_2-4-2-问题-2-cookie-无法被客户端存储" tabindex="-1">2.4.2 问题 2：Cookie 无法被客户端存储 <a class="header-anchor" href="#_2-4-2-问题-2-cookie-无法被客户端存储" aria-label="Permalink to &quot;2.4.2 问题 2：Cookie 无法被客户端存储&quot;">​</a></h4><ul><li>原因： <ul><li>Cookie 大小超过 4KB 或数量超过限制；</li><li>客户端浏览器禁用 Cookie；</li><li><code>setSecure(true)</code> 开启后，使用 HTTP 协议访问（Cookie 不传输）；</li><li><code>setDomain</code> 配置错误（如跨域设置）。</li></ul></li><li>解决方案： <ul><li>拆分大型 Cookie（减少单个 Cookie 大小）；</li><li>提示用户启用 Cookie（核心功能依赖时）；</li><li>生产环境使用 HTTPS 协议，或关闭 <code>setSecure</code>（仅测试环境）；</li><li>修正 <code>setDomain</code> 配置（确保与当前访问域名一致）。</li></ul></li></ul><h4 id="_2-4-3-问题-3-cookie-数据泄露-xss-攻击" tabindex="-1">2.4.3 问题 3：Cookie 数据泄露（XSS 攻击） <a class="header-anchor" href="#_2-4-3-问题-3-cookie-数据泄露-xss-攻击" aria-label="Permalink to &quot;2.4.3 问题 3：Cookie 数据泄露（XSS 攻击）&quot;">​</a></h4><ul><li>原因：客户端 JavaScript 可读取 Cookie 数据，XSS 攻击脚本可窃取敏感信息；</li><li>解决方案： <ul><li>开启 <code>setHttpOnly(true)</code>（禁止 JS 读取 Cookie）；</li><li>敏感数据（如用户 ID）加密后存储在 Cookie 中；</li><li>开启 <code>setSecure(true)</code>（仅 HTTPS 传输）。</li></ul></li></ul><h2 id="三、分层解耦-三层架构设计" tabindex="-1">三、分层解耦：三层架构设计 <a class="header-anchor" href="#三、分层解耦-三层架构设计" aria-label="Permalink to &quot;三、分层解耦：三层架构设计&quot;">​</a></h2><p>为解决代码耦合、提高可维护性，后端开发普遍采用「三层架构」，核心思想是「职责分离、逐层依赖」，每层仅关注自身核心功能，不干预其他层逻辑。</p><h3 id="_3-1-三层架构核心职责" tabindex="-1">3.1 三层架构核心职责 <a class="header-anchor" href="#_3-1-三层架构核心职责" aria-label="Permalink to &quot;3.1 三层架构核心职责&quot;">​</a></h3><table tabindex="0"><thead><tr><th>层级</th><th>核心职责</th><th>技术注解</th><th>依赖关系</th></tr></thead><tbody><tr><td>控制层（Controller）</td><td>接收前端请求、解析参数、校验请求合法性、返回响应结果（不处理业务逻辑）</td><td>Spring MVC：<code>@Controller</code>/<code>@RestController</code></td><td>依赖 Service 层（不直接依赖 Dao 层）</td></tr><tr><td>业务逻辑层（Service）</td><td>处理核心业务（如数据校验、逻辑计算、事务控制、多 Dao 协同）</td><td>Spring：<code>@Service</code></td><td>依赖 Dao 层</td></tr><tr><td>数据访问层（Dao/Mapper）</td><td>仅负责与数据库交互，执行 CRUD 操作（不包含任何业务逻辑）</td><td>Spring：<code>@Repository</code>；MyBatis：<code>@Mapper</code></td><td>不依赖其他层</td></tr></tbody></table><h4 id="_3-1-1-分层设计原则" tabindex="-1">3.1.1 分层设计原则 <a class="header-anchor" href="#_3-1-1-分层设计原则" aria-label="Permalink to &quot;3.1.1 分层设计原则&quot;">​</a></h4><ol><li>单向依赖：Controller → Service → Dao（禁止反向依赖，如 Dao 调用 Service）；</li><li>职责单一：每层只做自己的事（如 Controller 不写业务逻辑，Service 不直接操作 <code>HttpServletRequest</code>）；</li><li>事务集中：数据库事务（<code>@Transactional</code>）必须加在 Service 层（Dao 层方法可能被多个 Service 调用，事务边界不清晰）。</li></ol><h4 id="_3-1-2-错误示范与正确示例" tabindex="-1">3.1.2 错误示范与正确示例 <a class="header-anchor" href="#_3-1-2-错误示范与正确示例" aria-label="Permalink to &quot;3.1.2 错误示范与正确示例&quot;">​</a></h4><ul><li>错误示范（Controller 直接调用 Dao）： <ul><li><div class="language-Java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">Java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RestController</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> UserController</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // 错误：跳过 Service 层，直接依赖 Dao</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Autowired</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      private</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> UserDao userDao;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PostMapping</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/user/add&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      public</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Result </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addUser</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(User </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">user</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">          // 错误：业务逻辑（参数校验）写在 Controller</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">          if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (user.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getUsername</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">              return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Result.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;用户名不能为空&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          userDao.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">insert</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(user);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">          return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Result.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">success</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span></code></pre></div></li></ul></li><li>正确示范（分层协作）： <ul><li><div class="language-Java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">Java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Controller 层：仅接收请求、调用 Service</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RestController</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> UserController</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Autowired</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      private</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> UserService userService;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PostMapping</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/user/add&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      public</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Result </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addUser</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RequestBody</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> User </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">user</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">          return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> userService.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addUser</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(user);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Service 层：处理业务逻辑、调用 Dao</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Service</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Transactional</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // 事务控制在 Service 层</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> UserService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Autowired</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      private</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> UserDao userDao;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      public</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Result </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addUser</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(User </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">user</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">          // 业务逻辑：参数校验</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">          if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (StringUtils.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">isEmpty</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(user.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getUsername</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">              return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Result.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;用户名不能为空&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          }</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">          // 业务逻辑：判断用户名是否已存在</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">          if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (userDao.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">existsByUsername</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(user.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getUsername</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">              return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Result.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;用户名已存在&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          userDao.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">insert</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(user);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">          return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Result.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">success</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Dao 层：仅做 CRUD</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Repository</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> UserDao</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> insert</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(User </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">user</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      boolean</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> existsByUsername</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(String </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">username</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span></code></pre></div></li></ul></li></ul><h2 id="四、spring-核心-ioc-与-di-机制" tabindex="-1">四、Spring 核心：IOC 与 DI 机制 <a class="header-anchor" href="#四、spring-核心-ioc-与-di-机制" aria-label="Permalink to &quot;四、Spring 核心：IOC 与 DI 机制&quot;">​</a></h2><p>Spring 框架的核心是「控制反转（IOC）」和「依赖注入（DI）」，其目的是解除代码间的硬耦合，让对象的创建和依赖管理由 Spring 容器统一负责。</p><h3 id="_4-1-ioc-inversion-of-control-控制反转" tabindex="-1">4.1 IOC（Inversion of Control）：控制反转 <a class="header-anchor" href="#_4-1-ioc-inversion-of-control-控制反转" aria-label="Permalink to &quot;4.1 IOC（Inversion of Control）：控制反转&quot;">​</a></h3><h4 id="_4-1-1-核心思想" tabindex="-1">4.1.1 核心思想 <a class="header-anchor" href="#_4-1-1-核心思想" aria-label="Permalink to &quot;4.1.1 核心思想&quot;">​</a></h4><ul><li>传统开发：开发者手动 <code>new</code> 对象（如 <code>UserService userService = new UserServiceImpl()</code>），对象的创建、初始化、销毁全由开发者控制；</li><li>IOC 开发：开发者不再手动创建对象，而是将对象的创建权利「反转」给 Spring 容器，Spring 会自动创建对象并管理其生命周期（创建、初始化、销毁）。</li></ul><h4 id="_4-1-2-组件注册-让-spring-识别对象" tabindex="-1">4.1.2 组件注册：让 Spring 识别对象 <a class="header-anchor" href="#_4-1-2-组件注册-让-spring-识别对象" aria-label="Permalink to &quot;4.1.2 组件注册：让 Spring 识别对象&quot;">​</a></h4><p>要让 Spring 容器管理对象，需通过「组件注解」标记类，再通过「组件扫描」让 Spring 发现这些类。</p><h5 id="_1-常用组件注解-语义化分层注解" tabindex="-1">（1）常用组件注解（语义化分层注解） <a class="header-anchor" href="#_1-常用组件注解-语义化分层注解" aria-label="Permalink to &quot;（1）常用组件注解（语义化分层注解）&quot;">​</a></h5><table tabindex="0"><thead><tr><th>注解</th><th>适用层级</th><th>说明</th></tr></thead><tbody><tr><td><code>@Component</code></td><td>通用组件</td><td>无明确分层的组件（如工具类），Spring 通用注解</td></tr><tr><td><code>@Controller</code></td><td>控制层</td><td>Spring MVC 专用，标识控制器类，支持请求映射（<code>@RequestMapping</code>）</td></tr><tr><td><code>@RestController</code></td><td>控制层（接口）</td><td>等价于 <code>@Controller + @ResponseBody</code>，直接返回 JSON 响应（无需视图解析）</td></tr><tr><td><code>@Service</code></td><td>业务逻辑层</td><td>标识 Service 类，Spring 会自动为其添加事务支持（需配合 <code>@Transactional</code>）</td></tr><tr><td><code>@Repository</code></td><td>数据访问层</td><td>标识 Dao 类，Spring 会自动捕获数据库操作异常并转换为 Spring 统一异常</td></tr><tr><td><code>@Mapper</code></td><td>数据访问层（MyBatis）</td><td>MyBatis 专用注解，标识 Mapper 接口，需配合 <code>@MapperScan</code> 扫描</td></tr></tbody></table><h5 id="_2-组件扫描-componentscan" tabindex="-1">（2）组件扫描（<code>@ComponentScan</code>） <a class="header-anchor" href="#_2-组件扫描-componentscan" aria-label="Permalink to &quot;（2）组件扫描（`@ComponentScan`）&quot;">​</a></h5><p>Spring 需通过组件扫描才能发现带有上述注解的类，将其创建为对象（Bean）存入容器。</p><ul><li>扫描规则：扫描指定包及其子包下的所有类；</li><li>默认行为：Spring Boot 启动类若在根包（如 <code>com.imooc.springboot.Application</code>）下，无需手动添加 <code>@ComponentScan</code>，Spring 会自动扫描「启动类所在包及其子包」；</li><li>手动配置：若组件不在默认扫描路径下，需显式配置： <ul><li><div class="language-Java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">Java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Spring Boot 启动类</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SpringBootApplication</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 扫描多个包：逗号分隔</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ComponentScan</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;com.imooc.service&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;com.imooc.dao&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // MyBatis Mapper 扫描（单独配置）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">MapperScan</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;com.imooc.mapper&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Application</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> static</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[] </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">args</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          SpringApplication.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">run</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Application.class, args);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span></code></pre></div></li></ul></li></ul><h3 id="_4-2-di-dependency-injection-依赖注入" tabindex="-1">4.2 DI（Dependency Injection）：依赖注入 <a class="header-anchor" href="#_4-2-di-dependency-injection-依赖注入" aria-label="Permalink to &quot;4.2 DI（Dependency Injection）：依赖注入&quot;">​</a></h3><h4 id="_4-2-1-核心思想" tabindex="-1">4.2.1 核心思想 <a class="header-anchor" href="#_4-2-1-核心思想" aria-label="Permalink to &quot;4.2.1 核心思想&quot;">​</a></h4><p>依赖注入是 IOC 的具体实现：Spring 容器在创建对象时，自动将该对象依赖的其他对象（如 Controller 依赖的 Service、Service 依赖的 Dao）注入到对象中，无需开发者手动 <code>set</code> 或构造。</p><h4 id="_4-2-2-三种注入方式-对比与选型" tabindex="-1">4.2.2 三种注入方式（对比与选型） <a class="header-anchor" href="#_4-2-2-三种注入方式-对比与选型" aria-label="Permalink to &quot;4.2.2 三种注入方式（对比与选型）&quot;">​</a></h4><p>Spring 支持三种依赖注入方式，各有适用场景，推荐优先使用构造函数注入。</p><table tabindex="0"><thead><tr><th>注入方式</th><th>写法示例</th><th>优点</th><th>缺点</th><th>适用场景</th></tr></thead><tbody><tr><td>属性注入</td><td>注解直接加在字段上</td><td>写法最简单，代码简洁</td><td>1. 无法注入 <code>final</code> 字段；<br>2. 易引发循环依赖；<br>3. 测试时难以 Mock</td><td>小型项目、非核心组件</td></tr><tr><td>构造函数注入</td><td>注解加在构造函数上（Spring 4.3+ 单构造函数可省略 <code>@Autowired</code>）</td><td>1. 支持 <code>final</code> 字段；<br>2. 避免循环依赖；<br>3. 测试易 Mock；<br>4. 强制依赖初始化</td><td>字段较多时，构造函数代码较长</td><td>核心组件（如 Service、Controller）</td></tr><tr><td>Setter 注入</td><td>注解加在 <code>setXXX()</code> 方法上</td><td>灵活性高，可动态修改依赖</td><td>1. 不支持 <code>final</code> 字段；<br>2. 易被外部修改依赖，破坏封装</td><td>依赖可选、需动态调整的场景</td></tr></tbody></table><table tabindex="0"><thead><tr><th><strong>注入方式</strong></th><th><strong>写法示例</strong></th><th><strong>优点</strong></th><th><strong>缺点</strong></th></tr></thead><tbody><tr><td>属性注入（@Autowired 加在字段上）</td><td><code>@Autowired private UserService userService;</code></td><td>写法最简单</td><td>1. 不能注入 final 字段；2. 容易导致循环依赖；3. 测试时难以 mock</td></tr><tr><td>构造函数注入（@Autowired 加在构造函数上）</td><td><code>private UserService userService; @Autowired public UserController(UserService userService) { this.userService; }</code></td><td>1. 支持 final 字段；2. 避免循环依赖；3. 测试易 mock</td><td>写法稍繁琐（字段多时光构造函数长）</td></tr><tr><td>Setter 注入（@Autowired 加在 set 方法上）</td><td><code>private UserService userService; @Autowired public void setUserService(UserService userService) { this.userService = userService; }</code></td><td>灵活性高（可动态修改依赖）</td><td>不推荐：易被外部修改依赖，破坏封装</td></tr></tbody></table><h5 id="代码示例" tabindex="-1">代码示例 <a class="header-anchor" href="#代码示例" aria-label="Permalink to &quot;代码示例&quot;">​</a></h5><ol><li>属性注入： <ol><li><div class="language-Java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">Java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RestController</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> UserController</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     // 直接在字段上添加 @Autowired</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">     @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Autowired</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">     private</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> UserService userService;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span></code></pre></div></li></ol></li><li>构造函数注入（推荐）： <ol><li><div class="language-Java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">Java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RestController</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> UserController</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     // 可加 final（强制依赖，必须注入）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">     private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> final</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> UserService userService;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">     </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     // 单构造函数，省略 @Autowired</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">     public</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> UserController</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(UserService </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">userService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">         this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.userService </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> userService;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">     }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span></code></pre></div></li></ol></li><li>Setter 注入： <ol><li><div class="language-Java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">Java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RestController</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> UserController</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">     private</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> UserService userService;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">     </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     // 注解加在 set 方法上</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">     @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Autowired</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">     public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> setUserService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(UserService </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">userService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">         this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.userService </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> userService;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">     }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span></code></pre></div></li></ol></li></ol><h4 id="_4-2-3-注入冲突解决方案-多实现类场景" tabindex="-1">4.2.3 注入冲突解决方案（多实现类场景） <a class="header-anchor" href="#_4-2-3-注入冲突解决方案-多实现类场景" aria-label="Permalink to &quot;4.2.3 注入冲突解决方案（多实现类场景）&quot;">​</a></h4><p><code>@Autowired</code> 默认按「类型（Type）」注入，若某个接口有多个实现类，Spring 会因无法确定注入哪个而报错（<code>NoUniqueBeanDefinitionException</code>），解决方案如下：</p><h5 id="方案-1-qualifier-实例名称-精准匹配" tabindex="-1">方案 1：<code>@Qualifier</code> + 实例名称（精准匹配） <a class="header-anchor" href="#方案-1-qualifier-实例名称-精准匹配" aria-label="Permalink to &quot;方案 1：`@Qualifier` + 实例名称（精准匹配）&quot;">​</a></h5><p>通过 <code>@Service</code>/<code>@Component</code> 指定 Bean 名称，再用 <code>@Qualifier</code> 明确注入哪个 Bean。</p><div class="language-Java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">Java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 接口</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> UserService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Result </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addUser</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(User </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">user</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 实现类 1：指定 Bean 名称为 userServiceA</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Service</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;userServiceA&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> UserServiceImplA</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> implements</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> UserService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 实现逻辑</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 实现类 2：指定 Bean 名称为 userServiceB</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Service</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;userServiceB&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> UserServiceImplB</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> implements</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> UserService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 实现逻辑</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Controller 中指定注入 userServiceA</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RestController</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> UserController</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Autowired</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Qualifier</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;userServiceA&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 匹配 @Service 定义的名称</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    private</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> UserService userService;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h5 id="方案-2-primary-指定默认-bean" tabindex="-1">方案 2：<code>@Primary</code> 指定默认 Bean <a class="header-anchor" href="#方案-2-primary-指定默认-bean" aria-label="Permalink to &quot;方案 2：`@Primary` 指定默认 Bean&quot;">​</a></h5><p>在多个实现类中，用 <code>@Primary</code> 标记「默认优先注入」的 Bean，无需额外指定名称。</p><div class="language-Java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">Java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Service</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Primary</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // 优先注入该实现类</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> UserServiceImplA</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> implements</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> UserService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 实现逻辑</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Service</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> UserServiceImplB</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> implements</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> UserService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 实现逻辑</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 直接 @Autowired 会注入 UserServiceImplA</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RestController</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> UserController</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Autowired</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    private</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> UserService userService;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h5 id="方案-3-resource-按名称注入" tabindex="-1">方案 3：<code>@Resource</code> 按名称注入 <a class="header-anchor" href="#方案-3-resource-按名称注入" aria-label="Permalink to &quot;方案 3：`@Resource` 按名称注入&quot;">​</a></h5><p><code>@Resource</code> 是 JDK 原生注解（非 Spring 注解），默认按「名称（Name）」注入，可替代 <code>@Autowired + @Qualifier</code>，兼容性更强。</p><div class="language-Java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">Java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RestController</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> UserController</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // name 匹配 @Service 定义的 Bean 名称</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Resource</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;userServiceB&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    private</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> UserService userService;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="_4-3-核心概念总结" tabindex="-1">4.3 核心概念总结 <a class="header-anchor" href="#_4-3-核心概念总结" aria-label="Permalink to &quot;4.3 核心概念总结&quot;">​</a></h3><table tabindex="0"><thead><tr><th>术语</th><th>通俗理解</th></tr></thead><tbody><tr><td>IOC 容器</td><td>Spring 管理对象的「容器」，存储所有通过注解/配置创建的 Bean</td></tr><tr><td>Bean</td><td>被 Spring 容器管理的对象（如 Service、Dao、Controller 实例）</td></tr><tr><td>IOC</td><td>对象创建权利由开发者转移到 Spring 容器，解耦硬编码</td></tr><tr><td>DI</td><td>Spring 容器自动将依赖的 Bean 注入到目标对象中，无需手动管理依赖</td></tr></tbody></table><h2 id="五、实战流程串联-前后端交互完整链路" tabindex="-1">五、实战流程串联（前后端交互完整链路） <a class="header-anchor" href="#五、实战流程串联-前后端交互完整链路" aria-label="Permalink to &quot;五、实战流程串联（前后端交互完整链路）&quot;">​</a></h2><p>结合上述知识点，以下是一个完整的前后端交互开发流程（包含 Cookie+Session 状态保持）：</p><h3 id="_5-1-开发步骤" tabindex="-1">5.1 开发步骤 <a class="header-anchor" href="#_5-1-开发步骤" aria-label="Permalink to &quot;5.1 开发步骤&quot;">​</a></h3><ol><li><strong>定义接口协议</strong>：前后端约定 HTTP 请求方式、路径、参数、响应格式（例：<code>POST /api/login</code> 登录接口，<code>GET /api/user/info</code> 获取用户信息接口）；</li><li><strong>创建实体类</strong>（Entity/DTO）：定义 <code>UserLoginDTO</code>（登录请求参数）、<code>User</code>（用户实体）、<code>Result</code>（统一响应格式）；</li><li><strong>开发 Dao 层</strong>：用 <code>@Mapper</code> 定义 <code>UserMapper</code> 接口，编写查询用户的 SQL 方法；</li><li><strong>开发 Service 层</strong>：用 <code>@Service</code> 定义 <code>UserService</code> 类，注入 <code>UserMapper</code>，实现登录校验逻辑；</li><li><strong>开发 Controller 层</strong>：用 <code>@RestController</code> 定义 <code>UserController</code>，注入 <code>UserService</code>，实现登录（创建 Session）、获取用户信息（读取 Session）、退出登录（销毁 Session）接口；</li><li><strong>配置 Cookie 与 Session</strong>：在 <code>application.yml</code> 中配置 Session 超时时间、Cookie 安全属性；</li><li><strong>前后端联调</strong>：前端调用登录接口后，后续请求自动携带 Cookie（Session ID），后端通过 Session 识别登录状态。</li></ol><h3 id="_5-2-核心代码结构" tabindex="-1">5.2 核心代码结构 <a class="header-anchor" href="#_5-2-核心代码结构" aria-label="Permalink to &quot;5.2 核心代码结构&quot;">​</a></h3><div class="language-Plain vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">Plain</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>com.imooc.springboot</span></span>
<span class="line"><span>├── Application.java        // 启动类（@SpringBootApplication + @MapperScan）</span></span>
<span class="line"><span>├── controller</span></span>
<span class="line"><span>│   └── UserController.java  // 控制层（登录、用户信息接口）</span></span>
<span class="line"><span>├── service</span></span>
<span class="line"><span>│   └── UserService.java     // 业务层（登录校验逻辑）</span></span>
<span class="line"><span>├── mapper</span></span>
<span class="line"><span>│   └── UserMapper.java      // 数据访问层（查询用户）</span></span>
<span class="line"><span>├── entity</span></span>
<span class="line"><span>│   ├── User.java            // 用户实体类</span></span>
<span class="line"><span>│   └── UserLoginDTO.java    // 登录请求DTO</span></span>
<span class="line"><span>└── common</span></span>
<span class="line"><span>    └── Result.java          // 统一响应类</span></span></code></pre></div><h2 id="六、常见问题与避坑指南" tabindex="-1">六、常见问题与避坑指南 <a class="header-anchor" href="#六、常见问题与避坑指南" aria-label="Permalink to &quot;六、常见问题与避坑指南&quot;">​</a></h2><ol><li><strong><code>@ComponentScan</code></strong> <strong>扫描不到 Bean</strong>： <ol><li>检查注解是否正确（如 Controller 用 <code>@Controller</code> 而非 <code>@Component</code>）；</li><li>确认组件所在包是启动类的子包，或手动配置 <code>@ComponentScan</code> 扫描路径。</li></ol></li><li><strong>依赖注入报错（NoSuchBeanDefinitionException）</strong>： <ol><li>检查被注入的类是否加了组件注解（如 <code>@Service</code>）；</li><li>检查组件是否被 <code>@ComponentScan</code> 扫描到。</li></ol></li><li><strong>循环依赖问题</strong>（A 依赖 B，B 依赖 A）： <ol><li>优先用构造函数注入（Spring 会检测循环依赖并报错，提前发现问题）；</li><li>重构代码，提取公共依赖为第三方组件，解除循环。</li></ol></li><li><strong>事务不生效</strong>： <ol><li>事务注解 <code>@Transactional</code> 必须加在 Service 层（Controller 层事务不生效）；</li><li>确保事务方法是「public」（private 方法事务不生效）；</li><li>避免在同一个 Service 类中调用事务方法（AOP 无法拦截）。</li></ol></li><li><strong>HTTP 请求体解析失败</strong>： <ol><li>确保请求头 <code>Content-Type</code> 与请求体格式一致（如 JSON 对应 <code>application/json</code>）；</li><li>Controller 方法参数需加 <code>@RequestBody</code> 注解（解析 JSON 请求体）。</li></ol></li><li><strong>Session 登录状态丢失</strong>： <ol><li>检查 Session 超时时间是否过短（调整 <code>server.servlet.session.timeout</code>）；</li><li>跨域场景需配置 <code>Access-Control-Allow-Credentials: true</code> 和 <code>Access-Control-Allow-Origin</code>（指定具体域名，不能为 <code>*</code>）；</li><li>确认客户端未禁用 Cookie（或开启了隐私模式，会话级 Cookie 失效）。</li></ol></li><li><strong>Cookie 无法跨域携带</strong>： <ol><li>后端配置 CORS 时，需同时设置 <code>allowed-origins</code>（具体域名）、<code>allow-credentials: true</code>；</li><li>前端请求时需设置 <code>withCredentials: true</code>（Axios 等框架配置）。</li></ol></li></ol><h2 id="七、总结" tabindex="-1">七、总结 <a class="header-anchor" href="#七、总结" aria-label="Permalink to &quot;七、总结&quot;">​</a></h2><p>本文围绕 Web 核心知识、Spring 分层开发、Cookie 与 Session 状态保持展开，核心要点包括：</p><ol><li>HTTP 协议：请求/响应格式、核心头字段（<code>Set-Cookie</code>/<code>Cookie</code>）；</li><li>Cookie 与 Session：状态保持的核心机制，Cookie 存储在客户端（传递 Session ID），Session 存储在服务器端（存储敏感数据）；</li><li>三层架构：Controller（接收请求）→ Service（业务逻辑）→ Dao（数据访问）的职责与依赖关系；</li><li>Spring IOC/DI：组件注册、组件扫描、三种注入方式及冲突解决；</li><li>实战流程：包含登录状态保持的前后端交互完整链路与避坑指南。</li></ol><p>这些知识点是 Java 后端开发的基石，掌握后可应对大部分常规项目开发场景。实际开发中需注意 Cookie/Session 的安全配置、分层职责边界、依赖注入规范，同时结合框架特性（如 Spring Boot 自动配置、Redis 存储 Session）提高系统的安全性和扩展性。</p></div></div></main><footer class="VPDocFooter" data-v-e6f2a212 data-v-1bcd8184><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-1bcd8184><span class="visually-hidden" id="doc-footer-aria-label" data-v-1bcd8184>Pager</span><div class="pager" data-v-1bcd8184><!----></div><div class="pager" data-v-1bcd8184><a class="VPLink link pager-link next" href="/markdown-examples.html" data-v-1bcd8184><!--[--><span class="desc" data-v-1bcd8184>Next page</span><span class="title" data-v-1bcd8184>Markdown Examples</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"index.md\":\"BM0ndPae\",\"notes_core_一些个人理解.md\":\"BTGEMZ9h\",\"notes_core_中间件部分_docker.md\":\"Q9yhjP8H\",\"notes_core_中间件部分_rabbitmq.md\":\"CKiMHfM-\",\"notes_core_中间件部分_redis.md\":\"BBZKli9p\",\"notes_core_其他_android.md\":\"BMxOwNgT\",\"notes_core_其他_cmake.md\":\"Bzu1OuFP\",\"notes_core_其他_git.md\":\"ChiHvMdH\",\"notes_core_其他_java23种设计模式.md\":\"Cy7HyeEF\",\"notes_core_其他_javavirtualmachine.md\":\"CosUbXrO\",\"notes_core_其他_linux.md\":\"DH8JJuW5\",\"notes_core_其他_qt.md\":\"DWxEDS0u\",\"notes_core_其他_区块链.md\":\"DIsp4API\",\"notes_core_其他_小程序.md\":\"C-EjWNd1\",\"notes_core_其他_网络部分.md\":\"CKym3K81\",\"notes_core_其他_鸿蒙.md\":\"Bi7D1ylf\",\"notes_core_前端总结.md\":\"BXa_WZ6W\",\"notes_core_前端部分_css.md\":\"dUGbcxWR\",\"notes_core_前端部分_html5.md\":\"CaLHY3Sx\",\"notes_core_前端部分_javascript.md\":\"CN-rKMAI\",\"notes_core_前端部分_nodejs.md\":\"BO-iZqs8\",\"notes_core_前端部分_pinia和vuex.md\":\"DOTXcina\",\"notes_core_前端部分_react18.md\":\"DIpOKzX9\",\"notes_core_前端部分_rocketmq.md\":\"B6ug1Eu0\",\"notes_core_前端部分_typescript.md\":\"39VhBUnL\",\"notes_core_前端部分_vue.md\":\"B5zDf1ey\",\"notes_core_前端部分_移动web开发.md\":\"Cwv4wzYT\",\"notes_core_后端总结.md\":\"CnIfst1P\",\"notes_core_后端部分_mongodb.md\":\"hOkiUSJR\",\"notes_core_后端部分_mysql.md\":\"Cq9Rkt8o\",\"notes_core_后端部分_nginx.md\":\"C-4T2z8B\",\"notes_core_后端部分_spring框架_springboot.md\":\"zFN1s-ki\",\"notes_core_后端部分_spring框架_springcloud.md\":\"CEMFdr8u\",\"notes_core_后端部分_spring框架_springframe.md\":\"DIlc0h2B\",\"notes_core_后端部分_spring框架_springmvc.md\":\"DvSjfjT-\",\"notes_core_后端部分_spring框架_springsecurity.md\":\"DUGNnkfk\",\"notes_core_术语解释.md\":\"DpwO1iKU\",\"notes_core_杂七杂八的技术们_爬虫.md\":\"D4ke0dNn\",\"notes_core_架构部分_ajax.md\":\"DGzlzSJh\",\"notes_core_架构部分_jdbc.md\":\"DojjS4iE\",\"notes_core_架构部分_jsp.md\":\"BXZpvtKN\",\"notes_core_架构部分_kubernetes.md\":\"Dc9dcn_c\",\"notes_core_架构部分_mabits-plus.md\":\"CxefDgo2\",\"notes_core_架构部分_maven.md\":\"BD2H2Xiw\",\"notes_core_架构部分_mybatis.md\":\"DMLrzCQ5\",\"notes_core_架构部分_servlet.md\":\"BFaqCxEs\",\"notes_core_架构部分_tomcat.md\":\"Du14ZRs7\",\"notes_core_架构部分_vite.md\":\"DBFWUvv_\",\"notes_core_架构部分_webpack.md\":\"0PfLfPTe\",\"notes_core_架构部分_web与后端的架构问题.md\":\"Cl_y-d1c\",\"notes_core_架构部分_zookeeper.md\":\"xJDx6Os9\",\"notes_core_硬件部分_fpga.md\":\"Bj6Hz8Zl\",\"notes_core_硬件部分_stm32.md\":\"DXYypsdA\",\"notes_core_计算机牛马生存准则.md\":\"h2i8J5Uc\",\"notes_core_语言部分_c.md\":\"D9d7L1MX\",\"notes_core_语言部分_c__.md\":\"D7xhdsu7\",\"notes_core_语言部分_go.md\":\"Bvk6VP8X\",\"notes_core_语言部分_java.md\":\"D0dNFfxj\",\"notes_core_语言部分_kotlin.md\":\"CN5FNXAb\",\"notes_core_语言部分_python.md\":\"x41YKC5V\",\"notes_core_语言部分_rust.md\":\"Ovh7FQMF\",\"教程.md\":\"BFL9JbPa\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"godspead的全栈文档\",\"description\":\"记录我学过的一切\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"palette\":[{\"media\":\"(prefers-color-scheme: dark)\",\"colors\":{\"background\":\"#000000\",\"foreground\":\"#ffffff\",\"primary\":\"#ffffff\",\"secondary\":\"#666666\"}}],\"nav\":[{\"text\":\"Home\",\"link\":\"/\"},{\"text\":\"前端\",\"items\":[{\"text\":\"JavaScript\",\"link\":\"/notes/frontend/js\"},{\"text\":\"Vue\",\"link\":\"/notes/frontend/vue\"},{\"text\":\"CSS\",\"link\":\"/notes/frontend/css\"}]}],\"sidebar\":[{\"text\":\"Examples\",\"collapsible\":true,\"items\":[{\"text\":\"Markdown Examples\",\"link\":\"/markdown-examples\"},{\"text\":\"Runtime API Examples\",\"link\":\"/api-examples\"}]}],\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/vuejs/vitepress\"}]},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>