<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>我的笔记 | GitHub Pages</title>
    <!-- 引入 Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 引入 Font Awesome -->
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <!-- 引入 Marked.js 用于解析Markdown -->
    <script src="https://cdn.jsdelivr.net/npm/marked@4.0.2/marked.min.js"></script>
    <!-- 配置 Tailwind -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#165DFF',
                        secondary: '#FF7D00',
                        neutral: {
                            100: '#F5F7FA',
                            200: '#E5E6EB',
                            300: '#C9CDD4',
                            400: '#86909C',
                            500: '#4E5969',
                            600: '#272E3B',
                            700: '#1D2129',
                        },
                        contribution: {
                            0: '#EBEDF0',
                            1: '#9BE9A8',
                            2: '#40C463',
                            3: '#30A14E',
                            4: '#216E39'
                        }
                    },
                    fontFamily: {
                        inter: ['Inter', 'system-ui', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .text-shadow {
                text-shadow: 0 2px 4px rgba(0,0,0,0.1);
            }
            .card-hover {
                transition: all 0.3s ease;
            }
            .card-hover:hover {
                transform: translateY(-5px);
            }
            .scrollbar-hide::-webkit-scrollbar {
                display: none;
            }
            .bg-gradient {
                background: linear-gradient(135deg, #165DFF 0%, #0A337F 100%);
            }
            .contribution-cell {
                width: 11px;
                height: 11px;
                transition: transform 0.2s;
            }
            .contribution-cell:hover {
                transform: scale(1.5);
            }
            .contribution-weekday {
                font-size: 10px;
                color: #86909C;
                width: 11px;
                text-align: center;
            }
        }
    </style>
</head>
<body class="font-inter bg-neutral-100 text-neutral-700 min-h-screen flex flex-col">
    <!-- 导航栏 -->
    <header id="navbar" class="fixed w-full top-0 z-50 transition-all duration-300 bg-white/90 backdrop-blur-sm shadow-sm">
        <div class="container mx-auto px-4 py-3 flex items-center justify-between">
            <!-- 网站标题 -->
            <a href="#" class="flex items-center space-x-2">
                <i class="fa fa-book text-primary text-2xl"></i>
                <span class="text-xl font-bold text-neutral-700">笔记空间</span>
            </a>
            
            <!-- 搜索框 - 中等屏幕以上显示 -->
            <div class="hidden md:flex items-center flex-1 max-w-xl mx-8">
                <div class="relative w-full">
                    <input 
                        type="text" 
                        placeholder="搜索笔记..." 
                        class="w-full pl-10 pr-4 py-2 rounded-full bg-neutral-100 focus:outline-none focus:ring-2 focus:ring-primary/30 transition-all"
                    >
                    <i class="fa fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-neutral-400"></i>
                </div>
            </div>
            
            <!-- 导航菜单 -->
            <nav class="flex items-center space-x-1 md:space-x-4">
                <button class="md:hidden p-2 rounded-full hover:bg-neutral-100 transition-colors" id="searchToggle">
                    <i class="fa fa-search text-neutral-500"></i>
                </button>
                <button class="p-2 rounded-full hover:bg-neutral-100 transition-colors relative">
                    <i class="fa fa-bell text-neutral-500"></i>
                    <span class="absolute top-1 right-1 w-2 h-2 bg-secondary rounded-full"></span>
                </button>
                <button class="p-2 rounded-full hover:bg-neutral-100 transition-colors" id="themeToggle">
                    <i class="fa fa-moon-o text-neutral-500"></i>
                </button>
                <!-- 上传笔记按钮 -->
                <button id="uploadNoteBtn" class="hidden md:flex items-center space-x-1 bg-primary text-white px-3 py-1.5 rounded-lg hover:bg-primary/90 transition-colors">
                    <i class="fa fa-upload"></i>
                    <span>上传笔记</span>
                </button>
                <div class="relative group">
                    <button class="flex items-center space-x-1 p-1 rounded-full hover:bg-neutral-100 transition-colors">
                        <img src="https://picsum.photos/id/1005/40/40" alt="用户头像" class="w-8 h-8 rounded-full object-cover border-2 border-white shadow-sm">
                        <span class="hidden md:inline font-medium">用户名</span>
                        <i class="fa fa-angle-down text-neutral-400 text-xs"></i>
                    </button>
                    <!-- 用户下拉菜单 -->
                    <div class="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg py-2 z-50 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 transform group-hover:translate-y-0 translate-y-2">
                        <a href="#" class="block px-4 py-2 text-sm hover:bg-neutral-100 transition-colors">
                            <i class="fa fa-user mr-2 text-neutral-400"></i>个人资料
                        </a>
                        <a href="#" class="block px-4 py-2 text-sm hover:bg-neutral-100 transition-colors">
                            <i class="fa fa-cog mr-2 text-neutral-400"></i>设置
                        </a>
                        <div class="border-t border-neutral-200 my-1"></div>
                        <a href="#" class="block px-4 py-2 text-sm text-red-500 hover:bg-neutral-100 transition-colors">
                            <i class="fa fa-sign-out mr-2"></i>退出登录
                        </a>
                    </div>
                </div>
            </nav>
        </div>
        
        <!-- 移动端搜索框 -->
        <div class="md:hidden px-4 pb-3 hidden" id="mobileSearch">
            <div class="relative w-full">
                <input 
                    type="text" 
                    placeholder="搜索笔记..." 
                    class="w-full pl-10 pr-4 py-2 rounded-full bg-neutral-100 focus:outline-none focus:ring-2 focus:ring-primary/30 transition-all"
                >
                <i class="fa fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-neutral-400"></i>
            </div>
        </div>
    </header>

    <!-- 主内容区 -->
    <main class="flex-1 pt-16">
        <!-- 欢迎区域 -->
        <section class="bg-gradient text-white py-10 md:py-16">
            <div class="container mx-auto px-4">
                <div class="max-w-3xl">
                    <h1 class="text-[clamp(1.8rem,4vw,2.8rem)] font-bold leading-tight text-shadow mb-4">
                        记录学习，分享知识
                    </h1>
                    <p class="text-white/90 text-lg mb-6 max-w-2xl">
                        这是你的个人笔记空间，在这里整理你的学习心得、技术笔记和创意想法。
                    </p>
                    <div class="flex flex-wrap gap-4">
                        <button id="mobileUploadNoteBtn" class="flex items-center bg-white text-primary hover:bg-neutral-100 px-6 py-3 rounded-lg font-medium shadow-lg hover:shadow-xl transition-all">
                            <i class="fa fa-plus mr-2"></i>上传笔记
                        </button>
                        <button class="bg-transparent border-2 border-white/80 text-white hover:bg-white/10 px-6 py-3 rounded-lg font-medium transition-all flex items-center">
                            <i class="fa fa-folder-open mr-2"></i>浏览分类
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- 笔记和分类区域 -->
        <section class="container mx-auto px-4 py-8">
            <div class="flex flex-col lg:flex-row gap-8">
                <!-- 左侧分类 -->
                <div class="lg:w-1/4">
                    <div class="bg-white rounded-xl shadow-sm p-5 sticky top-24">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-lg font-bold text-neutral-700">笔记分类</h2>
                            <button class="text-primary hover:text-primary/80 text-sm font-medium">
                                管理
                            </button>
                        </div>
                        
                        <ul class="space-y-1">
                            <li>
                                <a href="#" class="flex items-center justify-between p-3 rounded-lg bg-primary/10 text-primary font-medium">
                                    <div class="flex items-center">
                                        <i class="fa fa-code mr-3 w-5 text-center"></i>
                                        <span>编程开发</span>
                                    </div>
                                    <span class="bg-primary/20 text-primary text-xs px-2 py-1 rounded-full">12</span>
                                </a>
                            </li>
                            <li>
                                <a href="#" class="flex items-center justify-between p-3 rounded-lg hover:bg-neutral-100 transition-colors">
                                    <div class="flex items-center">
                                        <i class="fa fa-terminal mr-3 w-5 text-center text-neutral-500"></i>
                                        <span>运维部署</span>
                                    </div>
                                    <span class="bg-neutral-100 text-neutral-500 text-xs px-2 py-1 rounded-full">8</span>
                                </a>
                            </li>
                            <li>
                                <a href="#" class="flex items-center justify-between p-3 rounded-lg hover:bg-neutral-100 transition-colors">
                                    <div class="flex items-center">
                                        <i class="fa fa-database mr-3 w-5 text-center text-neutral-500"></i>
                                        <span>数据库</span>
                                    </div>
                                    <span class="bg-neutral-100 text-neutral-500 text-xs px-2 py-1 rounded-full">5</span>
                                </a>
                            </li>
                            <li>
                                <a href="#" class="flex items-center justify-between p-3 rounded-lg hover:bg-neutral-100 transition-colors">
                                    <div class="flex items-center">
                                        <i class="fa fa-paint-brush mr-3 w-5 text-center text-neutral-500"></i>
                                        <span>设计</span>
                                    </div>
                                    <span class="bg-neutral-100 text-neutral-500 text-xs px-2 py-1 rounded-full">4</span>
                                </a>
                            </li>
                            <li>
                                <a href="#" class="flex items-center justify-between p-3 rounded-lg hover:bg-neutral-100 transition-colors">
                                    <div class="flex items-center">
                                        <i class="fa fa-book mr-3 w-5 text-center text-neutral-500"></i>
                                        <span>读书笔记</span>
                                    </div>
                                    <span class="bg-neutral-100 text-neutral-500 text-xs px-2 py-1 rounded-full">7</span>
                                </a>
                            </li>
                            <li>
                                <a href="#" class="flex items-center justify-between p-3 rounded-lg hover:bg-neutral-100 transition-colors">
                                    <div class="flex items-center">
                                        <i class="fa fa-lightbulb-o mr-3 w-5 text-center text-neutral-500"></i>
                                        <span>创意灵感</span>
                                    </div>
                                    <span class="bg-neutral-100 text-neutral-500 text-xs px-2 py-1 rounded-full">6</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
                
                <!-- 右侧笔记列表 -->
                <div class="lg:w-3/4">
                    <!-- 筛选和排序 -->
                    <div class="bg-white rounded-xl shadow-sm p-4 mb-6">
                        <div class="flex flex-wrap justify-between items-center gap-4">
                            <div class="flex items-center space-x-2">
                                <h2 class="text-lg font-bold text-neutral-700">编程开发笔记</h2>
                                <span class="bg-neutral-100 text-neutral-500 text-xs px-2 py-1 rounded-full">12篇</span>
                            </div>
                            
                            <div class="flex flex-wrap items-center gap-3">
                                <div class="flex rounded-lg overflow-hidden border border-neutral-200">
                                    <button class="px-3 py-1.5 bg-primary text-white text-sm">最新</button>
                                    <button class="px-3 py-1.5 text-neutral-500 hover:bg-neutral-100 text-sm transition-colors">最热</button>
                                    <button class="px-3 py-1.5 text-neutral-500 hover:bg-neutral-100 text-sm transition-colors">最早</button>
                                </div>
                                
                                <div class="relative">
                                    <button class="flex items-center space-x-1 px-3 py-1.5 border border-neutral-200 rounded-lg text-sm text-neutral-500 hover:bg-neutral-100 transition-colors">
                                        <i class="fa fa-filter"></i>
                                        <span>筛选</span>
                                    </button>
                                </div>
                                
                                <div class="flex rounded-lg overflow-hidden border border-neutral-200">
                                    <button class="p-1.5 bg-primary/10 text-primary">
                                        <i class="fa fa-th-large"></i>
                                    </button>
                                    <button class="p-1.5 text-neutral-400 hover:bg-neutral-100 transition-colors">
                                        <i class="fa fa-list"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 笔记卡片网格 -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6" id="notesGrid">
                        <!-- 笔记卡片 1 -->
                        <div class="bg-white rounded-xl shadow-sm overflow-hidden card-hover border border-neutral-200">
                            <div class="h-40 overflow-hidden">
                                <img src="https://picsum.photos/id/0/600/400" alt="Python数据分析笔记封面" class="w-full h-full object-cover transition-transform duration-500 hover:scale-110">
                            </div>
                            <div class="p-5">
                                <div class="flex items-center mb-3">
                                    <span class="bg-blue-100 text-blue-600 text-xs px-2 py-1 rounded-full">Python</span>
                                    <span class="ml-auto text-neutral-400 text-sm flex items-center">
                                        <i class="fa fa-calendar-o mr-1"></i> 2023-05-15
                                    </span>
                                </div>
                                <h3 class="font-bold text-lg mb-2 line-clamp-2 hover:text-primary transition-colors">
                                    <a href="#">Python数据分析入门：Pandas库常用操作总结</a>
                                </h3>
                                <p class="text-neutral-500 text-sm mb-4 line-clamp-2">
                                    本文总结了Pandas库的常用数据处理操作，包括数据读取、清洗、转换和基本分析方法，适合初学者快速上手。
                                </p>
                                <div class="flex justify-between items-center">
                                    <div class="flex items-center space-x-3">
                                        <span class="text-neutral-400 text-sm flex items-center">
                                            <i class="fa fa-eye mr-1"></i> 128
                                        </span>
                                        <span class="text-neutral-400 text-sm flex items-center">
                                            <i class="fa fa-comment-o mr-1"></i> 8
                                        </span>
                                    </div>
                                    <button class="text-neutral-400 hover:text-neutral-600 transition-colors">
                                        <i class="fa fa-bookmark-o"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 笔记卡片 2 -->
                        <div class="bg-white rounded-xl shadow-sm overflow-hidden card-hover border border-neutral-200">
                            <div class="h-40 overflow-hidden">
                                <img src="https://picsum.photos/id/160/600/400" alt="JavaScript异步编程笔记封面" class="w-full h-full object-cover transition-transform duration-500 hover:scale-110">
                            </div>
                            <div class="p-5">
                                <div class="flex items-center mb-3">
                                    <span class="bg-yellow-100 text-yellow-600 text-xs px-2 py-1 rounded-full">JavaScript</span>
                                    <span class="ml-auto text-neutral-400 text-sm flex items-center">
                                        <i class="fa fa-calendar-o mr-1"></i> 2023-05-10
                                    </span>
                                </div>
                                <h3 class="font-bold text-lg mb-2 line-clamp-2 hover:text-primary transition-colors">
                                    <a href="#">JavaScript异步编程：从回调到Promise再到Async/Await</a>
                                </h3>
                                <p class="text-neutral-500 text-sm mb-4 line-clamp-2">
                                    详解JavaScript异步编程的发展历程，对比回调函数、Promise和Async/Await的使用场景和优缺点。
                                </p>
                                <div class="flex justify-between items-center">
                                    <div class="flex items-center space-x-3">
                                        <span class="text-neutral-400 text-sm flex items-center">
                                            <i class="fa fa-eye mr-1"></i> 215
                                        </span>
                                        <span class="text-neutral-400 text-sm flex items-center">
                                            <i class="fa fa-comment-o mr-1"></i> 12
                                        </span>
                                    </div>
                                    <button class="text-primary hover:text-primary/80 transition-colors">
                                        <i class="fa fa-bookmark"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 分页 -->
                    <div class="mt-10 flex justify-center">
                        <nav class="flex items-center space-x-1">
                            <a href="#" class="w-10 h-10 flex items-center justify-center rounded-lg border border-neutral-200 text-neutral-400 hover:bg-neutral-100 transition-colors">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a href="#" class="w-10 h-10 flex items-center justify-center rounded-lg bg-primary text-white font-medium">1</a>
                            <a href="#" class="w-10 h-10 flex items-center justify-center rounded-lg border border-neutral-200 hover:bg-neutral-100 transition-colors">2</a>
                            <a href="#" class="w-10 h-10 flex items-center justify-center rounded-lg border border-neutral-200 hover:bg-neutral-100 transition-colors">3</a>
                            <span class="w-10 h-10 flex items-center justify-center text-neutral-400">...</span>
                            <a href="#" class="w-10 h-10 flex items-center justify-center rounded-lg border border-neutral-200 hover:bg-neutral-100 transition-colors">5</a>
                            <a href="#" class="w-10 h-10 flex items-center justify-center rounded-lg border border-neutral-200 text-neutral-500 hover:bg-neutral-100 transition-colors">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        </nav>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- 页脚 -->
    <footer class="bg-white border-t border-neutral-200 mt-12">
        <div class="container mx-auto px-4 py-8">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="flex items-center space-x-2 mb-4 md:mb-0">
                    <i class="fa fa-book text-primary text-xl"></i>
                    <span class="text-lg font-bold text-neutral-700">笔记空间</span>
                </div>
                
                <div class="flex space-x-6 mb-4 md:mb-0">
                    <a href="#" class="text-neutral-500 hover:text-primary transition-colors">
                        <i class="fa fa-github text-xl"></i>
                    </a>
                    <a href="#" class="text-neutral-500 hover:text-primary transition-colors">
                        <i class="fa fa-twitter text-xl"></i>
                    </a>
                    <a href="#" class="text-neutral-500 hover:text-primary transition-colors">
                        <i class="fa fa-linkedin text-xl"></i>
                    </a>
                    <a href="#" class="text-neutral-500 hover:text-primary transition-colors">
                        <i class="fa fa-envelope text-xl"></i>
                    </a>
                </div>
                
                <div class="text-neutral-400 text-sm">
                    &copy; 2023 笔记空间. 基于 GitHub Pages 构建.
                </div>
            </div>
        </div>
    </footer>

    <!-- 上传笔记模态框 -->
    <div id="uploadModal" class="fixed inset-0 bg-black/50 z-50 flex items-center justify-center opacity-0 invisible transition-all duration-300">
        <div class="bg-white rounded-xl shadow-xl w-full max-w-lg mx-4 transform transition-transform duration-300 scale-95">
            <div class="p-6 border-b border-neutral-200">
                <div class="flex justify-between items-center">
                    <h3 class="text-xl font-bold text-neutral-700">上传笔记</h3>
                    <button id="closeModalBtn" class="text-neutral-400 hover:text-neutral-600 transition-colors">
                        <i class="fa fa-times text-xl"></i>
                    </button>
                </div>
            </div>
            <div class="p-6">
                <form id="noteUploadForm">
                    <div class="mb-4">
                        <label for="noteTitle" class="block text-sm font-medium text-neutral-700 mb-1">笔记标题</label>
                        <input type="text" id="noteTitle" class="w-full px-4 py-2 border border-neutral-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/30 focus:border-primary transition-all" placeholder="输入笔记标题">
                    </div>
                    
                    <div class="mb-4">
                        <label for="noteCategory" class="block text-sm font-medium text-neutral-700 mb-1">分类</label>
                        <select id="noteCategory" class="w-full px-4 py-2 border border-neutral-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/30 focus:border-primary transition-all">
                            <option value="编程开发">编程开发</option>
                            <option value="运维部署">运维部署</option>
                            <option value="数据库">数据库</option>
                            <option value="设计">设计</option>
                            <option value="读书笔记">读书笔记</option>
                            <option value="创意灵感">创意灵感</option>
                        </select>
                    </div>
                    
                    <div class="mb-4">
                        <label for="noteTag" class="block text-sm font-medium text-neutral-700 mb-1">标签</label>
                        <input type="text" id="noteTag" class="w-full px-4 py-2 border border-neutral-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/30 focus:border-primary transition-all" placeholder="输入标签，多个标签用逗号分隔">
                    </div>
                    
                    <div class="mb-4">
                        <label for="noteFile" class="block text-sm font-medium text-neutral-700 mb-1">选择Markdown文件</label>
                        <div class="flex items-center justify-center w-full">
                            <label for="noteFile" class="flex flex-col items-center justify-center w-full h-32 border-2 border-dashed border-neutral-300 rounded-lg cursor-pointer bg-neutral-50 hover:bg-neutral-100 transition-colors">
                                <div class="flex flex-col items-center justify-center pt-5 pb-6">
                                    <i class="fa fa-cloud-upload text-3xl text-neutral-400 mb-2"></i>
                                    <p class="mb-1 text-sm text-neutral-500"><span class="font-semibold">点击上传</span> 或拖放文件</p>
                                    <p class="text-xs text-neutral-400">支持 .md 格式文件</p>
                                </div>
                                <input id="noteFile" type="file" accept=".md" class="hidden" />
                            </label>
                        </div>
                        <div id="filePreview" class="mt-2 text-sm text-neutral-600 hidden"></div>
                    </div>
                    
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-neutral-700 mb-1">笔记预览</label>
                        <div id="notePreview" class="w-full p-4 border border-neutral-300 rounded-lg bg-neutral-50 min-h-[100px] text-sm">
                            上传文件后将显示预览
                        </div>
                    </div>
                    
                    <div class="flex justify-end space-x-3 mt-6">
                        <button type="button" id="cancelUploadBtn" class="px-5 py-2 border border-neutral-300 rounded-lg text-neutral-700 hover:bg-neutral-100 transition-colors">取消</button>
                        <button type="submit" class="px-5 py-2 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors">提交笔记</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- 返回顶部按钮 -->
    <button id="backToTop" class="fixed bottom-6 right-6 w-12 h-12 bg-primary text-white rounded-full shadow-lg flex items-center justify-center opacity-0 invisible transition-all duration-300 hover:bg-primary/90">
        <i class="fa fa-arrow-up"></i>
    </button>

    <!-- JavaScript -->
    <script>
        // 页面加载完成后执行
        document.addEventListener('DOMContentLoaded', function() {
            // 导航栏滚动效果
            const navbar = document.getElementById('navbar');
            window.addEventListener('scroll', () => {
                if (window.scrollY > 50) {
                    navbar.classList.add('py-2', 'shadow');
                    navbar.classList.remove('py-3');
                } else {
                    navbar.classList.add('py-3');
                    navbar.classList.remove('py-2', 'shadow');
                }
            });
            
            // 移动端搜索框切换
            const searchToggle = document.getElementById('searchToggle');
            const mobileSearch = document.getElementById('mobileSearch');
            searchToggle.addEventListener('click', () => {
                mobileSearch.classList.toggle('hidden');
            });
            
            // 主题切换按钮
            const themeToggle = document.getElementById('themeToggle');
            themeToggle.addEventListener('click', () => {
                const icon = themeToggle.querySelector('i');
                if (icon.classList.contains('fa-moon-o')) {
                    icon.classList.remove('fa-moon-o');
                    icon.classList.add('fa-sun-o');
                    // 暗色模式切换逻辑
                    document.body.classList.add('dark-mode');
                } else {
                    icon.classList.remove('fa-sun-o');
                    icon.classList.add('fa-moon-o');
                    // 亮色模式切换逻辑
                    document.body.classList.remove('dark-mode');
                }
            });
            
            // 返回顶部按钮
            const backToTop = document.getElementById('backToTop');
            window.addEventListener('scroll', () => {
                if (window.scrollY > 300) {
                    backToTop.classList.remove('opacity-0', 'invisible');
                    backToTop.classList.add('opacity-100', 'visible');
                } else {
                    backToTop.classList.add('opacity-0', 'invisible');
                    backToTop.classList.remove('opacity-100', 'visible');
                }
            });
            
            backToTop.addEventListener('click', () => {
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            });
            
            // 平滑滚动
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    document.querySelector(this.getAttribute('href')).scrollIntoView({
                        behavior: 'smooth'
                    });
                });
            });
            
            // 初始化六行多列的贡献图
            initContributionGraph();
            
            // 上传笔记模态框控制
            const uploadNoteBtn = document.getElementById('uploadNoteBtn');
            const mobileUploadNoteBtn = document.getElementById('mobileUploadNoteBtn');
            const uploadModal = document.getElementById('uploadModal');
            const closeModalBtn = document.getElementById('closeModalBtn');
            const cancelUploadBtn = document.getElementById('cancelUploadBtn');
            
            function openModal() {
                uploadModal.classList.remove('opacity-0', 'invisible');
                uploadModal.classList.add('opacity-100', 'visible');
                uploadModal.querySelector('div').classList.remove('scale-95');
                uploadModal.querySelector('div').classList.add('scale-100');
                document.body.style.overflow = 'hidden';
            }
            
            function closeModal() {
                uploadModal.classList.add('opacity-0', 'invisible');
                uploadModal.classList.remove('opacity-100', 'visible');
                uploadModal.querySelector('div').classList.add('scale-95');
                uploadModal.querySelector('div').classList.remove('scale-100');
                document.body.style.overflow = '';
            }
            
            uploadNoteBtn.addEventListener('click', openModal);
            mobileUploadNoteBtn.addEventListener('click', openModal);
            closeModalBtn.addEventListener('click', closeModal);
            cancelUploadBtn.addEventListener('click', closeModal);
            
            // 点击模态框外部关闭
            uploadModal.addEventListener('click', function(e) {
                if (e.target === uploadModal) {
                    closeModal();
                }
            });
            
            // 文件选择和预览
            const noteFile = document.getElementById('noteFile');
            const filePreview = document.getElementById('filePreview');
            const notePreview = document.getElementById('notePreview');
            
            noteFile.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    // 显示文件名
                    filePreview.textContent = `已选择: ${file.name}`;
                    filePreview.classList.remove('hidden');
                    
                    // 读取文件内容并预览
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const content = e.target.result;
                        // 使用marked.js将Markdown转换为HTML
                        notePreview.innerHTML = marked.parse(content.substring(0, 500)) + '<p class="text-neutral-400">... 预览已截断</p>';
                    };
                    reader.readAsText(file);
                } else {
                    filePreview.classList.add('hidden');
                    notePreview.innerHTML = '上传文件后将显示预览';
                }
            });
            
            // 表单提交处理
            const noteUploadForm = document.getElementById('noteUploadForm');
            noteUploadForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const title = document.getElementById('noteTitle').value;
                const category = document.getElementById('noteCategory').value;
                const tag = document.getElementById('noteTag').value;
                const file = noteFile.files[0];
                
                if (!title || !file) {
                    alert('请填写标题并选择文件');
                    return;
                }
                
                // 创建新笔记卡片
                createNewNoteCard(title, category, tag, file.name);
                
                // 更新贡献图
                updateContributionGraph();
                
                // 更新统计数字
                updateNoteCounts();
                
                // 关闭模态框并重置表单
                closeModal();
                noteUploadForm.reset();
                filePreview.classList.add('hidden');
                notePreview.innerHTML = '上传文件后将显示预览';
                
                // 显示成功提示
                alert('笔记上传成功！');
            });
        });
        
        // 初始化六行多列的贡献图（显示过去6个月）
        function initContributionGraph() {
            const contributionGrid = document.getElementById('contributionGrid');
            const today = new Date();
            
            // 计算6个月前的日期
            const sixMonthsAgo = new Date();
            sixMonthsAgo.setMonth(today.getMonth() - 6);
            
            // 从本地存储获取贡献数据，如无则初始化
            let contributions = JSON.parse(localStorage.getItem('noteContributions')) || {};
            
            // 六行多列布局参数（6行×26列 = 156天，约6个月）
            const rows = 6;         // 六行
            const cols = 26;        // 26列
            const totalDays = rows * cols;  // 156天
            
            let currentDate = new Date(sixMonthsAgo);
            
            // 调整起始日期为周一，使六行对应周一至周六
            const dayOfWeek = currentDate.getDay() || 7; // 将周日的0转换为7
            if (dayOfWeek > 1) {
                currentDate.setDate(currentDate.getDate() - (dayOfWeek - 1));
            }
            
            // 生成贡献图网格 - 六行多列布局
            for (let day = 0; day < totalDays; day++) {
                const dateStr = currentDate.toISOString().split('T')[0];
                
                // 如果没有该日期的数据，初始化为0
                if (!contributions[dateStr]) {
                    contributions[dateStr] = 0;
                }
                
                // 确定贡献等级（0-4）
                let level = 0;
                if (contributions[dateStr] > 0) level = 1;
                if (contributions[dateStr] > 1) level = 2;
                if (contributions[dateStr] > 3) level = 3;
                if (contributions[dateStr] > 5) level = 4;
                
                // 创建格子元素
                const cell = document.createElement('div');
                cell.className = `contribution-cell bg-contribution-${level} rounded-sm`;
                cell.title = `${dateStr}: ${contributions[dateStr]} 篇笔记`;
                cell.dataset.date = dateStr;
                contributionGrid.appendChild(cell);
                
                // 移动到下一天
                currentDate.setDate(currentDate.getDate() + 1);
            }
            
            // 保存贡献数据
            localStorage.setItem('noteContributions', JSON.stringify(contributions));
        }
        
        // 更新贡献图（添加新提交）
        function updateContributionGraph() {
            const today = new Date().toISOString().split('T')[0];
            let contributions = JSON.parse(localStorage.getItem('noteContributions')) || {};
            
            // 增加今天的贡献数
            if (contributions[today]) {
                contributions[today]++;
            } else {
                contributions[today] = 1;
            }
            
            // 更新对应的格子
            const cell = document.querySelector(`.contribution-cell[data-date="${today}"]`);
            if (cell) {
                let level = 0;
                if (contributions[today] > 0) level = 1;
                if (contributions[today] > 1) level = 2;
                if (contributions[today] > 3) level = 3;
                if (contributions[today] > 5) level = 4;
                
                // 移除旧的等级类
                for (let i = 0; i <= 4; i++) {
                    cell.classList.remove(`bg-contribution-${i}`);
                }
                
                // 添加新的等级类
                cell.classList.add(`bg-contribution-${level}`);
                cell.title = `${today}: ${contributions[today]} 篇笔记`;
            }
            
            // 保存更新后的贡献数据
            localStorage.setItem('noteContributions', JSON.stringify(contributions));
        }
        
        // 创建新笔记卡片
        function createNewNoteCard(title, category, tag, fileName) {
            const notesGrid = document.getElementById('notesGrid');
            const today = new Date();
            const dateStr = `${today.getFullYear()}-${String(today.getMonth() + 1).padStart(2, '0')}-${String(today.getDate()).padStart(2, '0')}`;
            
            // 随机图片ID
            const imageId = Math.floor(Math.random() * 200);
            
            // 创建卡片HTML
            const cardHtml = `
                <div class="bg-white rounded-xl shadow-sm overflow-hidden card-hover border border-neutral-200 animate-fade-in">
                    <div class="h-40 overflow-hidden">
                        <img src="https://picsum.photos/id/${imageId}/600/400" alt="${title}封面" class="w-full h-full object-cover transition-transform duration-500 hover:scale-110">
                    </div>
                    <div class="p-5">
                        <div class="flex items-center mb-3">
                            <span class="bg-blue-100 text-blue-600 text-xs px-2 py-1 rounded-full">${tag.split(',')[0] || category}</span>
                            <span class="ml-auto text-neutral-400 text-sm flex items-center">
                                <i class="fa fa-calendar-o mr-1"></i> ${dateStr}
                            </span>
                        </div>
                        <h3 class="font-bold text-lg mb-2 line-clamp-2 hover:text-primary transition-colors">
                            <a href="#">${title}</a>
                        </h3>
                        <p class="text-neutral-500 text-sm mb-4 line-clamp-2">
                            从文件 "${fileName}" 导入的笔记内容，点击查看详情。
                        </p>
                        <div class="flex justify-between items-center">
                            <div class="flex items-center space-x-3">
                                <span class="text-neutral-400 text-sm flex items-center">
                                    <i class="fa fa-eye mr-1"></i> 0
                                </span>
                                <span class="text-neutral-400 text-sm flex items-center">
                                    <i class="fa fa-comment-o mr-1"></i> 0
                                </span>
                            </div>
                            <button class="text-neutral-400 hover:text-neutral-600 transition-colors">
                                <i class="fa fa-bookmark-o"></i>
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            // 将新卡片添加到网格开头
            notesGrid.insertAdjacentHTML('afterbegin', cardHtml);
            
            // 添加淡入动画
            const newCard = notesGrid.firstElementChild;
            newCard.style.opacity = '0';
            newCard.style.transform = 'translateY(20px)';
            newCard.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
            
            setTimeout(() => {
                newCard.style.opacity = '1';
                newCard.style.transform = 'translateY(0)';
            }, 10);
        }
        
        // 更新笔记统计数字
        function updateNoteCounts() {
            const totalNotesCount = document.getElementById('totalNotesCount');
            const monthlyNotesCount = document.getElementById('monthlyNotesCount');
            
            // 增加总笔记数
            const currentTotal = parseInt(totalNotesCount.textContent);
            totalNotesCount.textContent = currentTotal + 1;
            
            // 增加本月笔记数
            const currentMonthly = parseInt(monthlyNotesCount.textContent);
            monthlyNotesCount.textContent = currentMonthly + 1;
        }
    </script>
</body>
</html>
